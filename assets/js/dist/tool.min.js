function refresh(e){$$$(e)[0].contentWindow.location.reload()}function hide(e){$$$(e).hide()}function show(e){$$$(e).show()}function elementExists(e){return $$$(e).length?!0:void 0}var action=function(){var e={};return e.setup=function(e){data=e,panel_url=data.root_url+"/"+action.getOption("panel","panel")+"/pages/"+data.admin_slug+"/edit",site_url=data.root_url+"/"+data.page_slug},e.setView=function(e){$$$("body")[0].setAttribute("data-view",e),mem.setLocal("view",e)},e.is_json=function(e){try{var t=JSON.parse(e)}catch(n){return!1}return!0},e.getOption=function(e,t){var n="";return n=data.hasOwnProperty(e)?data[e]:t},e.addIframe=function(e,t){var n=document.createElement("iframe");return n.src=t,$$$(e)[0].appendChild(n),n},e.debugData=function(){data.debug===!0&&(console.log("Options JS:"),console.log(data))},e}(),address=function(){var e={};return e.init=function(){address.setAddress("section.panel .url input",panel_url),address.setAddress("section.site .url input",site_url)},e.setAddress=function(e,t){$$$(e)[0].value=t},e.setAddresses=function(){var e=$$$("section.site iframe")[0].contentWindow.location.href,t=$$$("section.panel iframe")[0].contentWindow.location.href;site_url!=e&&(address.setAddress("section.site .url input",e),site_url=e),panel_url!=t&&(address.setAddress("section.panel .url input",t),panel_url=t)},e}(),dropdown=function(){var e={},t=!1;e.init=function(){n()};var n=function(){i("panel"),i("site"),o()},i=function(e){$$$("section."+e+" .dropdown").forEach(function(t){var n=t.previousSibling.previousSibling;n.addEventListener("click",function(t){var i=$$$("body")[0].getAttribute("data-dropdown"),o=$$$("body")[0].getAttribute("data-bar"),c=n.parentNode.getAttribute("class"),s=c.split(" ")[0];i?(r(),(i!=s||o!=e)&&a(s,e)):a(s,e)})})},o=function(){$$$(".bar .hide .button").click(function(e){r()}),$$$(".bar .show .button").click(function(e){r()}),$$$(".bar .url .button-refresh").click(function(e){r()}),$$$(".bar .left").click(function(e){r()}),$$$(".dropdown li").click(function(e){r()})},r=function(){$$$("body")[0].removeAttribute("data-dropdown"),$$$("body")[0].removeAttribute("data-bar")},a=function(e,t){$$$("body")[0].setAttribute("data-dropdown",e),$$$("body")[0].setAttribute("data-bar",t)};return e}(),event=function(){var e={};return e.shared=function(e){event.exit(e),event.view(e),event.enterUrl(e),event.refresh(e)},e.events=function(){event.shared("panel"),event.shared("site"),event.buttonView("panel"),event.buttonView("site"),event.buttonView("columns"),event.buttonView("rows")},e.refresh=function(e){$$$("section."+e+" .button-refresh").click(function(t){refresh("section."+e+" iframe")})},e.view=function(e){$$("li."+e).forEach(function(t){t.addEventListener("click",function(t){action.setView(e)})})},e.buttonView=function(e){$$$(".dropdown li."+e).click(function(t){action.setView(e)})},e.enterUrl=function(e){$$$("section."+e+" .url input").keypress(function(t){if(13==event.keyCode){var n=$$$("section."+e+" .url input")[0].value;$$$("section."+e+" iframe")[0].setAttribute("src",n)}})},e.exit=function(e){$$("section."+e+" li.exit").forEach(function(t){t.addEventListener("click",function(t){window.location.href=$$$("section."+e+" iframe")[0].contentWindow.document.location.href})})},e}(),$$=function(e,t){t=t||document;var n=t.querySelectorAll(e);return Array.prototype.slice.call(n)},$$$=function(e,t){t=t||document;var n=Array.prototype.slice.call(t.querySelectorAll(e));return n.click=function(e){n.forEach(function(t){t.addEventListener("click",function(t){t.stopPropagation(),e.apply(n,[t])})})},n.keypress=function(e){n.forEach(function(t){t.addEventListener("keypress",function(t){t.stopPropagation(),e.apply(n,[t])})})},n.show=function(e){n.forEach(function(e){e.classList.add("active")})},n.hide=function(e){n.forEach(function(e){e.classList.remove("active")})},n.blur=function(e){n.forEach(function(e){e.blur()})},n.focus=function(e){n.forEach(function(e){e.focus()})},n.toggle=function(e){n.forEach(function(e){e.classList.toggle("active")})},n.hasClass=function(e){n.forEach(function(t){return t.classList.contains(e)?!0:void 0})},n},mem=function(){var e={};return e.init=function(){mem.setMemory(),mem.loadMemory()},e.setLocal=function(e,t){memory[e]=t;var n=JSON.stringify(memory);localStorage.setItem("splitview.memory",n)},e.setMemory=function(){if(localStorage.getItem("splitview.memory")){var e=localStorage.getItem("splitview.memory");action.is_json(e)&&(memory=JSON.parse(e))}},e.getMemory=function(e,t){var n="";return n=memory&&memory.hasOwnProperty(e)?memory[e]:t},e.loadMemory=function(){data.memory===!0?action.setView(mem.getMemory("view","columns")):action.setView(action.getOption("view","columns"))},e}(),menu=function(){var e={};e.init=function(){t()};var t=function(){n("panel"),i("panel"),n("site"),i("site")},n=function(e){var t="section."+e+" .bar li.hide";$$$(t+" .button").click(function(t){var n=$$$("body")[0].getAttribute("data-menu-"+e);"true"!==n&&$$$("body")[0].setAttribute("data-menu-"+e,!0)})},i=function(e){var t="section."+e+" .bar li.show";$$$(t+" .button").click(function(n){console.log(t);var i=$$$("body")[0].getAttribute("data-menu-"+e);"true"===i&&$$$("body")[0].removeAttribute("data-menu-"+e)})};return e}(),panel=function(){var e={};e.init=function(){t()};var t=function(){n("section.panel li.sync")},n=function(e){$$$(e).forEach(function(e){e.addEventListener("click",function(e){l()})})};e.panelMessageHide=function(){var e=document.createElement("style"),t=$$$("section.panel iframe")[0].contentWindow.document.querySelector("body").appendChild(e);t.innerHTML=".message { display: none; }"};var i=function(e){$$$("section.panel .message-saved")[0].classList.remove("active"),$$$("section.site .message-saved")[0].classList.remove("active")},o=function(e){$$$("section.panel .message-error")[0].classList.remove("active"),$$$("section.site .message-error")[0].classList.remove("active")},r=function(e,t){return str=t.slice(-e.length),str===e&&(t=t.slice(0,-e.length)),t};e.triggerErrorMessage=function(){var e=$$$("section.panel iframe")[0].contentWindow.document.querySelector(".message-is-alert");e&&(e.remove(),$$$("section.panel .message-error")[0].classList.add("active"),$$$("section.site .message-error")[0].classList.add("active"),setTimeout(o,4e3))},e.triggerSavedMessage=function(){var e=$$$("section.panel iframe")[0].contentWindow.document.querySelector(".message-is-notice");e?panel_state="saved":(panel_refreshed=!1,panel_state="closed"),"saved"===panel_state&&0==panel_refreshed&&(e.remove(),$$$("section.panel .message-saved")[0].classList.add("active"),$$$("section.site .message-saved")[0].classList.add("active"),refresh("section.site iframe"),panel_refreshed=!0,setTimeout(i,4e3))};var a=function(e){return e=e.split("/file/")[0],e=r("/edit",e),e=r("/files",e),e=r("/subpages",e)},c=function(){return $$$("section.panel iframe")[0].contentWindow.location.href},s=function(){return data.root_url+"/"+action.getOption("panel","panel")+"/pages"},u=function(){return c().replace(s(),"")},l=function(){var e=a(u());site_url=data.root_url+e,site.setUrl(site_url)};return e}(),site=function(){var e={};return e.setUrl=function(e){$$$("section.site iframe")[0].contentWindow.location.href=e},e}(),data={},iframe_count=0,panel_url,site_url,panel_state,panel_refreshed=!0,memory={},splitview=function(){var e={};return e.init=function(e){panel.init(),action.setup(e),action.debugData(),action.addIframe("section.panel .iframe",panel_url),action.addIframe("section.site .iframe",site_url),dropdown.init(),menu.init(),address.init(),surface.init(),mem.init(),copy.init(),SiteSync.init(),event.events()},e}(),surface=function(){var e={};return e.init=function(){surface.focusRootOnLoad("section.panel iframe"),surface.focusRootOnLoad("section.site iframe")},e.focus=function(e){$$$(e).focus()},e.blur=function(e){$$$(e).blur()},e.focusRoot=function(){surface.blur("section.panel iframe"),surface.blur("section.site iframe"),surface.focus(".splitview")},e.focusRootOnLoad=function(e){iframe=$$$(e)[0],iframe.onload=function(){iframe_count++,2==iframe_count&&(surface.focusRoot(),panel.panelMessageHide(),timeloop.events())}},e}(),timeloop=function(){var e={};return e.events=function(){address.setAddresses(),panel.triggerSavedMessage(),panel.triggerErrorMessage(),setTimeout(timeloop.events,200)},e}(),copy=function(){var e={};e.init=function(){t()};var t=function(){$$$("section.panel .flash .copy").click(function(e){n()}),$$$("section.site .flash .copy").click(function(e){i()})},n=function(){var e=$$$("section.panel iframe")[0].contentWindow.document.location.href;$$$("section.site iframe")[0].contentWindow.document.location.href=e},i=function(){var e=$$$("section.site iframe")[0].contentWindow.document.location.href;$$$("section.panel iframe")[0].contentWindow.document.location.href=e};return e}(),SiteSync=function(){var e={};e.init=function(){t()};var t=function(){n("section.site li.sync")},n=function(e){$$$(e).click(function(e){i()})},i=function(){if(r()){var e=r().getAttribute("data-splitview-id");$$$("section.panel iframe")[0].contentWindow.document.location.href=o(e)}},o=function(e){return data.root_url+"/"+action.getOption("panel","panel")+"/pages/"+e+"/edit"},r=function(){var e=document.querySelector("section.site iframe"),t=e.contentWindow.document.querySelector(".splitview-data");return t};return e}();