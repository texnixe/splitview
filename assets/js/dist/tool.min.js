function hide(t){$$$(t).hide()}function show(t){$$$(t).show()}function elementExists(t){return $$$(t).length?!0:void 0}var action=function(){var t={};return t.is_json=function(t){try{JSON.parse(t)}catch(e){return!1}return!0},t.getOption=function(t,e){var n="";return n=data.hasOwnProperty(t)?data[t]:e},t.debugData=function(){data.debug===!0&&(console.log("Options JS:"),console.log(data))},t}(),address=function(){var t={};return t.render=function(t,e){$$$(t+" .url input")[0].value=e},t.update=function(e,n,o){var r=$$$(e+" iframe")[0].contentWindow.location.href;r!=n&&(t.render(e,r),url[o]=r)},t}(),addresses=function(){var t={};return t.render=function(){for(var t=1;t<url.length;t++)address.render('[data-section="'+t+'"]',url[t])},t.update=function(){for(var t=1;t<url.length;t++)address.update('[data-section="'+t+'"]',url[t],t)},t}(),mem=function(){var t={};return t.init=function(){mem.setMemory(),mem.loadMemory()},t.setLocal=function(t,e){memory[t]=e;var n=JSON.stringify(memory);localStorage.setItem("splitview.memory",n)},t.setMemory=function(){if(localStorage.getItem("splitview.memory")){var t=localStorage.getItem("splitview.memory");action.is_json(t)&&(memory=JSON.parse(t))}},t.getMemory=function(t,e){var n="";return n=memory&&memory.hasOwnProperty(t)?memory[t]:e},t.loadMemory=function(){data.memory===!0?view.setView(mem.getMemory("view","columns")):view.setView(action.getOption("view","columns"))},t}(),data={},iframe_count=0,url=[],panel_state,panel_refreshed=!0,memory={},splitview=function(){var t={};return t.init=function(t){setup.init(t),action.debugData(),iframes.render(),addresses.render(),dropdowns.toggle(),dropdown.eventRemove(),focus.rootsOnLoad(),mem.init(),copy.init(),flip.init(),InputEnter.init(),InputClick.init(),Show.init(),Sync.init(),Refresh.init(),view.init(),exit.init()},t}(),copy=function(){var t,e,n={};n.init=function(){o()};var o=function(){for(var t=1;t<url.length;t++)r(t)},r=function(e){$$$('[data-section="'+e+'"] .flash .copy').click(function(o){t=e,n.setSectionTarget(),n.render(),dropdown.remove()})};return n.render=function(){var n=$$$('[data-section="'+t+'"] iframe')[0],o=$$$('[data-section="'+e+'"] iframe')[0],r=n.contentWindow.document.location.href;o.contentWindow.document.location.href=r},n.setSectionTarget=function(){e=1===t?2:1},n}(),dropdown=function(){var t={};t.toggle=function(n,o){$$$(n+" .dropdown").forEach(function(n){var r=n.previousSibling.previousSibling;r.addEventListener("click",function(n){var i=$$$("body")[0].getAttribute("data-dropdown"),a=$$$("body")[0].getAttribute("data-bar"),c=r.parentNode.getAttribute("class"),u=c.split(" ")[0];i?(t.remove(),(i!=u||a!=o)&&e(u,o)):e(u,o)})})},t.eventRemove=function(){$$$(".bar .hide .button").click(function(e){t.remove()}),$$$(".bar .show .button").click(function(e){t.remove()}),$$$(".bar .url .button-refresh").click(function(e){t.remove()}),$$$(".bar .left").click(function(e){t.remove()})},t.remove=function(){$$$("body")[0].removeAttribute("data-dropdown"),$$$("body")[0].removeAttribute("data-bar")};var e=function(t,e){$$$("body")[0].setAttribute("data-dropdown",t),$$$("body")[0].setAttribute("data-bar",e)};return t}(),dropdowns=function(){var t={};return t.toggle=function(){for(var t=1;t<url.length;t++)dropdown.toggle('[data-section="'+t+'"]',t)},t}(),Error=function(){var t={};return t.init=function(){for(var e=1;e<url.length;e++)t.onError(e)},t.onError=function(e){var n=$$$('[data-section="'+e+'"] iframe')[0].contentWindow.document.querySelector(".message-is-alert");n&&(n.remove(),t.renderMessage(),setTimeout(t.removeMessage,4e3))},t.renderMessage=function(){for(var t=1;t<url.length;t++)$$$('[data-section="'+t+'"] .message-error')[0].classList.add("active")},t.removeMessage=function(){for(var t=1;t<url.length;t++)$$$('[data-section="'+t+'"] .message-error')[0].classList.remove("active")},t}(),exit=function(){var t={};t.init=function(){e()};var e=function(){n("1"),n("2")},n=function(t){$$$('[data-section="'+t+'"] li.exit').click(function(e){var n=$$$('[data-section="'+t+'"] iframe')[0].contentWindow.document.location.href;2==e.which?(e.preventDefault(),o(n)):r(n)})},o=function(t){var e=window.open(t,"_blank");e.focus()},r=function(t){window.location.href=t};return t}(),flip=function(){var t={};t.init=function(){e()};var e=function(){$$$(".bar .flip").click(function(t){n(),dropdown.remove()})},n=function(){"true"!=$$$("body")[0].getAttribute("data-flip")?$$$("body")[0].setAttribute("data-flip","true"):$$$("body")[0].setAttribute("data-flip","false")};return t}(),iframe=function(){var t={};return t.render=function(t,e){var n=document.createElement("iframe");return n.src=e,$$$(t+" .iframe")[0].appendChild(n),n},t}(),iframes=function(){var t={};return t.render=function(){for(var t=1;t<url.length;t++)iframe.render('[data-section="'+t+'"]',url[t])},t}(),InputClick=function(){var t,e={},n=!1;return e.init=function(){for(var t=1;t<url.length;t++)e.event(t)},e.event=function(t){e.eventClick(t),e.eventBlur(t),e.eventEscape(t)},e.eventClick=function(o){$$$('[data-section="'+o+'"] .input input').click(function(r){t=o,e.addAttribute(),0==n&&this[0].select(),n=!0})},e.eventBlur=function(n){t=n,$$$('[data-section="'+n+'"] .input input')[0].onblur=e.setBlur},e.setBlur=function(){window.getSelection().removeAllRanges(),n=!1},e.eventEscape=function(n){$$$('[data-section="'+n+'"] .url input').keyup(function(o){27==event.keyCode&&(t=n,window.getSelection().removeAllRanges(),e.deleteAttribute(n))})},e.addAttribute=function(){$$$('[data-section="'+t+'"]')[0].setAttribute("data-input","")},e.deleteAttribute=function(t){$$$('[data-section="'+t+'"]')[0].removeAttribute("data-input")},e}(),InputEnter=function(){var t,e,n={};return n.init=function(){for(var t=1;t<url.length;t++)n.event(t)},n.event=function(e){$$$('[data-section="'+e+'"] .url input').keypress(function(o){13==event.keyCode&&(t=e,n.setValue(),n.action(),InputClick.deleteAttribute(e))})},n.setValue=function(){e=$$$('[data-section="'+t+'"] .url input')[0].value},n.action=function(){$$$('[data-section="'+t+'"] iframe')[0].setAttribute("src",e)},n}(),Refresh=function(){var t,e={};return e.init=function(){for(var t=1;t<url.length;t++)e.event(t)},e.event=function(n){$$$('[data-section="'+n+'"] .refresh').click(function(o){t=n,e.action(t),dropdown.remove()})},e.action=function(t){$$$('[data-section="'+t+'"] iframe')[0].contentWindow.location.reload()},e}(),Save=function(){var t={};return t.init=function(){for(var e=1;e<url.length;e++)t.event(e)},t.event=function(e){t.onSave(e)},t.onSave=function(e){var n=$$$('[data-section="'+e+'"] iframe')[0].contentWindow.document.querySelector(".message-is-notice");n?panel_state="saved":(panel_refreshed=!1,panel_state="closed"),"saved"===panel_state&&0==panel_refreshed&&(n.remove(),t.renderMessage(),Refresh.action(t.flip(e)),panel_refreshed=!0,setTimeout(t.removeMessage,4e3))},t.renderMessage=function(){for(var t=1;t<url.length;t++)$$$('[data-section="'+t+'"] .message-saved')[0].classList.add("active")},t.removeMessage=function(){for(var t=1;t<url.length;t++)$$$('[data-section="'+t+'"] .message-saved')[0].classList.remove("active")},t.flip=function(t){return 1===t?2:1},t}(),setup=function(){var t={};return t.init=function(t){data=t,url[1]=data.root_url+"/"+action.getOption("panel","panel")+"/pages/"+data.admin_slug+"/edit",url[2]=data.root_url+"/"+data.page_slug},t}(),Show=function(){var t={};return t.init=function(){for(var e=1;e<url.length;e++)t.event(e)},t.event=function(t){$$$('[data-section="'+t+'"] .show .button').click(function(e){InputClick.deleteAttribute(t)})},t}(),SyncPanel=function(){var t,e,n,o,r,i,a,c,u={};return u.action=function(t,e){a=t,r=e,i=u.flip(r),u.sync()},u.sync=function(){u.setUrlIframe(),u.setUrlPages(),u.setUrlNoPages(),u.setUrlNoParts(),u.setSiteUrl(),u.renderUrl()},u.setUrlPages=function(){e=data.root_url+"/"+action.getOption("panel","panel")+"/pages"},u.setUrlNoPages=function(){n=t.replace(e,"")},u.setUrlIframe=function(){t=$$$('[data-section="'+r+'"] iframe')[0].contentWindow.location.href},u.setUrlNoParts=function(){var t=n.split("/file/")[0];t=u.removeLast("/edit",t),t=u.removeLast("/files",t),t=u.removeLast("/subpages",t),o=t},u.setSiteUrl=function(){c=data.root_url+o},u.removeLast=function(t,e){return str=e.slice(-t.length),str===t&&(e=e.slice(0,-t.length)),e},u.renderUrl=function(){$$$('[data-section="'+i+'"] iframe')[0].contentWindow.location.href=c},u.flip=function(t){return 1===t?2:1},u}(),SiteSync=function(){var t,e,n,o,r,i={},a="";i.action=function(n,o){a=n,t=o,e=f(t),r=d(),c()};var c=function(){if(r){s(),u();var t=$$$('[data-section="'+e+'"] iframe')[0];t.contentWindow.document.location.href=n}},u=function(){n=data.root_url+"/"+action.getOption("panel","panel")+"/pages/"+o+"/edit"},s=function(){o=r.getAttribute("data-splitview-id")},f=function(t){return 1===t?2:1},d=function(){var e=document.querySelector('[data-section="'+t+'"] iframe'),n=e.contentWindow.document.querySelector(".splitview-data");return n};return i}(),Sync=function(){var t,e={},n={};return e.init=function(){for(var t=1;t<url.length;t++)e.event(t)},e.event=function(n){$$$('[data-section="'+n+'"] .sync').click(function(o){t=n,e.setTypes(),e.cases(),dropdown.remove()})},e.setTypes=function(){n[1]=$$$('[data-section="1"][data-type]')[0].getAttribute("data-type"),n[2]=$$$('[data-section="2"][data-type]')[0].getAttribute("data-type")},e.cases=function(){"panel"===n[t]?SyncPanel.action(n[t],t):"site"===n[t]&&SiteSync.action(n[t],t)},e}(),view=function(){var t={};t.init=function(){e()};var e=function(){buttonView("section1"),buttonView("section2"),buttonView("columns"),buttonView("rows")};return buttonView=function(e){$$$(".dropdown li."+e).click(function(n){t.setView(e),dropdown.remove()})},t.setView=function(t){$$$("body")[0].setAttribute("data-view",t),mem.setLocal("view",t)},t}(),blur=function(){var t={};return t.render=function(t){$$$(t).blur()},t}(),focus=function(){var t={};return t.rootOnLoad=function(e){iframe=$$$(e+" iframe")[0],iframe.onload=function(){iframe_count++,2==iframe_count&&(t.root(),messages.hide(),timeloop.events())}},t.rootsOnLoad=function(){for(var e=1;e<url.length;e++)t.rootOnLoad('[data-section="'+e+'"]')},t.render=function(t){$$$(t).focus()},t.root=function(){blur.render("section.panel iframe"),blur.render("section.site iframe"),focus.render(".splitview")},t}(),$$$=function(t,e){e=e||document;var n=Array.prototype.slice.call(e.querySelectorAll(t));return n.click=function(t){n.forEach(function(e){e.addEventListener("click",function(e){e.stopPropagation(),t.apply(n,[e])})})},n.mouseover=function(t){n.forEach(function(e){e.addEventListener("mouseenter",function(e){e.stopPropagation(),t.apply(n,[e])})})},n.mouseout=function(t){n.forEach(function(e){e.addEventListener("mouseleave",function(e){e.stopPropagation(),t.apply(n,[e])})})},n.keypress=function(t){n.forEach(function(e){e.addEventListener("keypress",function(e){e.stopPropagation(),t.apply(n,[e])})})},n.keyup=function(t){n.forEach(function(e){e.addEventListener("keyup",function(e){e.stopPropagation(),t.apply(n,[e])})})},n.show=function(t){n.forEach(function(t){t.classList.add("active")})},n.hide=function(t){n.forEach(function(t){t.classList.remove("active")})},n.blur=function(t){n.forEach(function(t){t.blur()})},n.focus=function(t){n.forEach(function(t){t.focus()})},n.toggle=function(t){n.forEach(function(t){t.classList.toggle("active")})},n.hasClass=function(t){n.forEach(function(e){return e.classList.contains(t)?!0:void 0})},n},message=function(){var t={};return t.hide=function(t){var e=document.createElement("style"),n=$$$(t+" iframe")[0].contentWindow.document.querySelector("body").appendChild(e);n.innerHTML=".message { display: none; }"},t}(),messages=function(){var t={};return t.hide=function(){for(var t=1;t<url.length;t++)message.hide('[data-section="'+t+'"]')},t}(),section=function(){var t={};t.update=function(){for(var t=1;t<url.length;t++)e('[data-section="'+t+'"]',url[t],t)};var e=function(t,e,r){n(t,e,r),o(t,e,r)},n=function(t,e,n){var o=$$$(t+" iframe")[0].contentWindow.document.querySelector(".splitview-data");if(o){var r=$$$(t)[0].getAttribute("data-type");"site"!==r&&$$$(t)[0].setAttribute("data-type","site")}},o=function(t,e,n){var o=$$$(t+" iframe")[0].contentWindow.document.querySelector("title");if(o&&" | Panel"==o.innerHTML.substr(-8)){var r=$$$(t)[0].getAttribute("data-type");"panel"!==r&&$$$(t)[0].setAttribute("data-type","panel")}};return t}(),timeloop=function(){var t={};return t.events=function(){section.update(),addresses.update(),Save.init(),Error.init(),setTimeout(t.events,200)},t}();